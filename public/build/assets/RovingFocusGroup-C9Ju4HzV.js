import{c as q,a as D}from"./Presence-DdyIZjaa.js";import{S as C,P as U}from"./Primitive-Cx6Px44i.js";import{h as B,c as G}from"./index-ByIodvIB.js";import{p as v,c as T,G as $,C as k,d as y,l as L,ai as V,a6 as R,D as z,U as K,g as j,o as Y,w as _,e as H,u as A,z as J}from"./app-Dk7wiUrI.js";import{g as h}from"./getActiveElement-FUKBWQwh.js";function M(){const e=v(),o=T(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:B(e));return{primitiveElement:e,currentElement:o}}const x="data-reka-collection-item";function Q(e={}){const{key:o="",isProvider:l=!1}=e,t=`${o}CollectionProvider`;let r;if(l){const a=v(new Map);r={collectionRef:v(),itemMap:a},$(t,r)}else r=k(t);const I=(a=!1)=>{const n=r.collectionRef.value;if(!n)return[];const s=Array.from(n.querySelectorAll(`[${x}]`)),c=Array.from(r.itemMap.value.values()).sort((f,p)=>s.indexOf(f.ref)-s.indexOf(p.ref));return a?c:c.filter(f=>f.ref.dataset.disabled!=="")},S=y({name:"CollectionSlot",setup(a,{slots:n}){const{primitiveElement:s,currentElement:u}=M();return z(u,()=>{r.collectionRef.value=u.value}),()=>R(C,{ref:s},n)}}),F=y({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:n,attrs:s}){const{primitiveElement:u,currentElement:c}=M();return L(f=>{if(c.value){const p=V(c.value);r.itemMap.value.set(p,{ref:c.value,value:a.value}),f(()=>r.itemMap.value.delete(p))}}),()=>R(C,{...s,[x]:"",ref:u},n)}}),w=T(()=>Array.from(r.itemMap.value.values())),g=T(()=>r.itemMap.value.size);return{getItems:I,reactiveItems:w,itemMapSize:g,CollectionSlot:S,CollectionItem:F}}const W="rovingFocusGroup.onEntryFocus",X={bubbles:!1,cancelable:!0},Z={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ee(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ue(e,o,l){const t=ee(e.key,l);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return Z[t]}function te(e,o=!1){const l=h();for(const t of e)if(t===l||(t.focus({preventScroll:o}),h()!==l))return}function ce(e,o){return e.map((l,t)=>e[(o+t)%e.length])}const[fe,oe]=q("RovingFocusGroup");var re=y({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:o,emit:l}){const t=e,r=l,{loop:I,orientation:S,dir:F}=K(t),w=D(F),g=G(t,"currentTabStopId",r,{defaultValue:t.defaultCurrentTabStopId,passive:t.currentTabStopId===void 0}),a=v(!1),n=v(!1),s=v(0),{getItems:u,CollectionSlot:c}=Q({isProvider:!0});function f(i){const m=!n.value;if(i.currentTarget&&i.target===i.currentTarget&&m&&!a.value){const E=new CustomEvent(W,X);if(i.currentTarget.dispatchEvent(E),r("entryFocus",E),!E.defaultPrevented){const b=u().map(d=>d.ref).filter(d=>d.dataset.disabled!==""),O=b.find(d=>d.getAttribute("data-active")===""),P=b.find(d=>d.id===g.value),N=[O,P,...b].filter(Boolean);te(N,t.preventScrollOnEntryFocus)}}n.value=!1}function p(){setTimeout(()=>{n.value=!1},1)}return o({getItems:u}),oe({loop:I,dir:w,orientation:S,currentTabStopId:g,onItemFocus:i=>{g.value=i},onItemShiftTab:()=>{a.value=!0},onFocusableItemAdd:()=>{s.value++},onFocusableItemRemove:()=>{s.value--}}),(i,m)=>(Y(),j(A(c),null,{default:_(()=>[H(A(U),{tabindex:a.value||s.value===0?-1:0,"data-orientation":A(S),as:i.as,"as-child":i.asChild,dir:A(w),style:{outline:"none"},onMousedown:m[0]||(m[0]=E=>n.value=!0),onMouseup:p,onFocus:f,onBlur:m[1]||(m[1]=E=>a.value=!1)},{default:_(()=>[J(i.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),de=re;export{de as R,M as a,te as f,ue as g,fe as i,Q as u,ce as w};
